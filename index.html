<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>é­”æ³•å¤©èµ‹æµ‹éªŒ</title>
    <style>
        /* CSS æ ·å¼éƒ¨åˆ† */
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            width: 100%;
            font-family: "Songti SC", "SimSun", "Times New Roman", serif;
            color: #4e342e;
            overflow: hidden;
            -webkit-tap-highlight-color: transparent;
        }

        .bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            /* è¯·ç¡®ä¿ bg.jpg å­˜åœ¨ */
            background-image: url('bg.jpg'); 
            background-size: 100% 100%; 
            background-repeat: no-repeat;
            z-index: -1;
        }

        /* --- æ–°å¢ï¼šéŸ³ä¹æ§åˆ¶æŒ‰é’®æ ·å¼ --- */
        #music-control {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
            background: rgba(78, 52, 46, 0.8);
            border: 2px solid #fff8e1;
            border-radius: 50%;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(255, 248, 225, 0.3);
            transition: transform 0.3s;
        }

        #music-icon {
            font-size: 20px;
            color: #fff8e1;
            /* é»˜è®¤ä¸æ—‹è½¬ï¼Œæ’­æ”¾æ—¶æ·»åŠ æ—‹è½¬ç±» */
        }

        /* éŸ³ä¹æ’­æ”¾æ—¶çš„æ—‹è½¬åŠ¨ç”» */
        .music-playing {
            animation: rotateDisk 4s linear infinite;
        }

        @keyframes rotateDisk {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* éŸ³ä¹å…³é—­æ—¶çš„æ–œçº¿æ ·å¼ï¼ˆå¯é€‰ï¼‰ */
        .music-off {
            opacity: 0.6;
        }
        /* --------------------------- */

        .container {
            position: relative;
            height: 100%;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            box-sizing: border-box;
            padding: 20% 10%; 
        }

        .page {
            display: none;
            width: 100%;
            height: 100%;
            flex-direction: column;
            align-items: center;
        }

        #intro-page { display: flex; justify-content: center; animation: fadeIn 1s ease; }

        .title {
            font-size: 2rem;
            font-weight: bold;
            color: #3e2723;
            margin-bottom: 20px;
            text-align: center;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .text-line {
            font-size: 1.1rem;
            line-height: 1.8;
            color: #5d4037;
            text-align: center;
        }

        .magic-btn {
            background: #4e342e;
            color: #fff8e1;
            border: 2px solid #3e2723;
            border-radius: 25px;
            padding: 10px 40px;
            font-size: 1.2rem;
            font-weight: bold;
            margin-top: 40px;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(62, 39, 35, 0.4);
            transition: transform 0.1s, opacity 0.5s ease, transform 0.5s ease;
        }
        .magic-btn:active { transform: scale(0.95); }

        .question-header {
            font-size: 0.9rem;
            color: #8d6e63;
            border-bottom: 1px solid #8d6e63;
            padding-bottom: 5px;
            margin-bottom: 20px;
            margin-top: 20px;
        }

        .question-text {
            font-size: 1.3rem;
            font-weight: bold;
            color: #3e2723;
            margin-bottom: 30px;
            line-height: 1.4;
            text-align: left;
            width: 100%;
        }

        .option-btn {
            background: rgba(255, 255, 255, 0.6);
            border: 2px solid #6d4c41;
            color: #3e2723;
            width: 100%;
            margin-bottom: 15px;
            font-size: 1rem;
            border-radius: 8px;
            padding: 15px;
            text-align: left;
            cursor: pointer;
            line-height: 1.4;
            transition: all 0.2s;
        }

        .option-active {
            background: #4e342e !important;
            color: #fff8e1 !important;
            border-color: #3e2723 !important;
            transform: scale(0.98);
        }

        .result-content {
            text-align: center;
            padding-top: 20px;
            width: 100%;
            overflow-y: auto; 
        }
        
        .reveal-item {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
        }

        .result-name {
            font-size: 3.5rem;
            font-weight: bold;
            color: #b71c1c;
            margin: 15px 0;
            display: block;
            text-shadow: 0 2px 5px rgba(0,0,0,0.2);
            transition-delay: 0.2s; 
        }

        .divider {
            width: 60%;
            height: 2px;
            background-color: #3e2723;
            margin: 10px auto 20px auto;
            transition-delay: 0.5s;
        }

        #result-desc {
            transition-delay: 0.8s;
        }

        .outro-text {
            font-size: 0.95rem;
            line-height: 1.7;
            margin-top: 20px;
            transition-delay: 1.1s;
        }

        #result-page .magic-btn {
            transition-delay: 1.4s;
        }

        .revealed {
            opacity: 1;
            transform: translateY(0);
        }

        #loading-page {
            justify-content: center;
        }
        .calculating-text {
            font-size: 1.2rem;
            color: #5d4037;
            animation: pulse 1.8s infinite ease-in-out;
        }

        @keyframes pulse {
            0% { opacity: 0.6; transform: scale(0.98); }
            50% { opacity: 1; transform: scale(1.02); }
            100% { opacity: 0.6; transform: scale(0.98); }
        }

        .spacer { height: 150px; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>

    <div class="bg"></div>

    <!-- --- æ–°å¢ï¼šéŸ³é¢‘æ ‡ç­¾å’Œæ§åˆ¶æŒ‰é’® --- -->
    <!-- è¯·å°† src æ”¹ä¸ºä½ å®é™…çš„éŸ³ä¹æ–‡ä»¶è·¯å¾„ï¼Œä¾‹å¦‚ 'music.mp3' -->
    <audio id="bgm" src="bgm.mp3" loop preload="auto"></audio>
    
    <div id="music-control" onclick="toggleBGM()">
        <div id="music-icon" class="music-off">ğŸµ</div>
    </div>
    <!-- -------------------------------- -->

    <div class="container">
        
        <!-- 1. å¯¼è¨€é¡µ -->
        <div id="intro-page" class="page">
            <div class="title">æ¬¢è¿ä½ ï¼Œæœ‹å‹ï¼</div>
            <div class="text-line">é­”æ³•çš„å¸·å¹•å·²ä¸ºä½ æ‹‰å¼€ï¼Œ</div>
            <div class="text-line">å®Œæˆä½ çš„å…¥å­¦æµ‹éªŒï¼Œ</div>
            <div class="text-line">æ­å¼€ä½ å‘½ä¸­æ³¨å®šçš„å¤©èµ‹é­”æ³•ã€‚</div>
            <button class="magic-btn" onclick="startQuiz()">å¼€å¯æµ‹éªŒ</button>
        </div>

        <!-- 2. ç­”é¢˜é¡µ -->
        <div id="quiz-page" class="page">
            <div id="q-count" class="question-header">ç¬¬ 1 é¢˜ / å…± 5 é¢˜</div>
            <div id="q-text" class="question-text">é¢˜ç›®åŠ è½½ä¸­...</div>
            <div id="options-box"></div>
        </div>

        <!-- 3. åŠ è½½é¡µ -->
        <div id="loading-page" class="page">
            <div class="calculating-text">æ­£åœ¨è§£æä½ çš„é­”æ³•å¤©èµ‹...</div>
        </div>

        <!-- 4. ç»“æœé¡µ -->
        <div id="result-page" class="page">
            <div class="result-content">
                <div class="reveal-item" style="font-size: 0.9rem; color: #8d6e63; transition-delay: 0s;">âœ¨ æµ‹éªŒå®Œæˆ âœ¨</div>
                <div class="reveal-item" style="font-size: 1.1rem; margin-top:10px; transition-delay: 0.1s;">ä½ çš„å¤©èµ‹æ˜¯</div>
                
                <div id="result-title" class="result-name reveal-item">åšå­¦</div>
                <div class="divider reveal-item"></div>
                <div id="result-desc" class="text-line reveal-item" style="text-align: justify; padding: 0 10px;"></div>
                
                <div class="outro-text reveal-item">
                    <div>å¥‘çº¦å·²æˆï¼Œä½ çš„é­”æ³•ä¹‹è·¯æ­£å¼å¯ç¨‹ï¼</div>
                    <div>æ— è®ºä½ æœªæ¥å»å‘ä½•å¤„ï¼Œ</div>
                    <div>æ¢ç´¢ï¼Œå·§æ€ï¼Œåšå­¦ä¸åˆ›æ–°</div>
                    <div>éƒ½å°†æ˜¯ä½ æœ€å¼ºå¤§çš„å’’è¯­ã€‚</div>
                    <div style="font-weight: bold; margin-top:15px; color:#3e2723; font-size: 1.1rem;">â€œæœ€ä¼Ÿå¤§çš„é­”æ³•ï¼Œæ˜¯ç›¸ä¿¡è‡ªå·±ã€‚â€</div>
                </div>

                <button class="magic-btn reveal-item" onclick="location.reload()" style="margin-bottom: 20px;">å†æ¬¡æµ‹éªŒ</button>
                <div class="spacer"></div>
            </div>
        </div>

    </div>

    <script>
        const questions = [
            {
                question: "1ã€è¸å…¥æœªçŸ¥çš„é­”æ³•é¢†åŸŸï¼Œä½ ä¼šå¦‚ä½•å¼€å¯æ¢ç´¢ä¹‹æ—…ï¼Ÿ",
                options: [
                    { text: "A. ç»˜åˆ¶é­”æ³•çŸ¥è¯†æ˜Ÿå›¾ï¼Œæ­å»ºå®Œæ•´çš„å’’è¯­ä¸ç¬¦æ–‡ä½“ç³»", value: "A" },
                    { text: "B. æŒ£è„±å¤è€é­”æ³•å…¸ç±çš„æŸç¼šï¼Œç”¨è·¨ç•Œè§†è§’å”¤é†’æ²‰ç¡çš„ç¥ç§˜åŠ›é‡", value: "B" }
                ]
            },
            {
                question: "2ã€é­é‡æ£˜æ‰‹çš„é­”æ³•éš¾é¢˜æ—¶ï¼Œä½ çš„ç ´å±€ä¹‹é“æ˜¯ï¼Ÿ",
                options: [
                    { text: "A. æ‹†è§£é­”æ³•èƒ½é‡çš„æµè½¬è„‰ç»œï¼Œæ¨æ¼”æœ€ç²¾å‡†çš„æ–½æ³•æ–¹æ¡ˆ", value: "A" },
                    { text: "B. æŒ¥åŠ¨é­”æ³•æ–å¤§èƒ†å°è¯•ï¼Œåœ¨å®è·µä¸­æ•æ‰çµå…‰ä¸€é—ªçš„çªç ´å¥‘æœº", value: "B" }
                ]
            },
            {
                question: "3ã€ç ”ä¹ å…¨æ–°é­”æ³•æŠ€èƒ½æ—¶ï¼Œä½ æ›´ä¸“æ³¨äºï¼Ÿ",
                options: [
                    { text: "A. æ´æ‚‰é­”æ³•çš„æœ¬æºåŸç†ä¸å¤è€ä¼ æ‰¿èƒŒæ™¯", value: "A" },
                    { text: "B. æ¢å¯»å’’è¯­ã€æ³•å™¨ä¸åœºæ™¯çš„å¤šå…ƒé€‚é…é€»è¾‘", value: "B" }
                ]
            },
            {
                question: "4ã€é¢å¯¹æµä¼ å·²ä¹…çš„ä¼ ç»Ÿé­”æ³•ï¼Œä½ æ›´æ¸´æœ›ï¼Ÿ",
                options: [
                    { text: "A. æŒ–æ˜å…¶éšè—çš„å»¶ä¼¸æ³•æœ¯ï¼Œè§£é”æ›´å¤šæœªçŸ¥ç”¨æ³•", value: "A" },
                    { text: "B. èåˆè‡ªèº«é­”åŠ›ç‰¹è´¨ï¼Œåˆ›é€ é¢ è¦†ä¼ ç»Ÿçš„å…¨æ–°é­”æ³•èŒƒå¼", value: "B" }
                ]
            },
            {
                question: "5ã€é—²æš‡æ—¶æ¢ç§˜é­”æ³•æ–°äº‹ç‰©ï¼Œä½ ä¼šé€‰æ‹©ï¼Ÿ",
                options: [
                    { text: "A. æœé›†å„åœ°é­”æ³•å·è½´ä¸å¤ç±ï¼Œå…¨é¢æ´æ‚‰å…¶å¥¥ç§˜", value: "A" },
                    { text: "B. æ²‰æµ¸å¼å‚¬åŠ¨é­”åŠ›äº²èº«å°è¯•ï¼Œåœ¨å®è·µä¸­å‘ç°æ„å¤–æƒŠå–œ", value: "B" }
                ]
            }
        ];

        const resultDescriptions = {
            "åšå­¦": { title: "åšå­¦", desc: "ä½ æ‹¥æœ‰æ·±é‚ƒçš„æ™ºæ…§ï¼Œå¦‚åŒå¤è€çš„å›¾ä¹¦é¦†ï¼ŒåŒ…ç½—ä¸‡è±¡ï¼Œæ´æ‚‰çœŸç†ã€‚" },
            "æ¢ç´¢": { title: "æ¢ç´¢", desc: "ä½ æ‹¥æœ‰æ— å°½çš„å¥½å¥‡å¿ƒï¼Œä¸–ç•Œçš„è¾¹ç•Œåœ¨ä½ è„šä¸‹ä¸æ–­å»¶ä¼¸ï¼ŒæœªçŸ¥æ˜¯ä½ æœ€å¥½çš„æœ‹å‹ã€‚" },
            "å·§æ€": { title: "å·§æ€", desc: "ä½ çš„æ€ç»´çµåŠ¨è€Œæ•æ·ï¼Œæ€»èƒ½åœ¨å›°å±€ä¸­æ‰¾åˆ°æ„æƒ³ä¸åˆ°çš„æ·å¾„ï¼ŒåŒ–è…æœ½ä¸ºç¥å¥‡ã€‚" },
            "åˆ›æ–°": { title: "åˆ›æ–°", desc: "ä½ æ˜¯è§„åˆ™çš„æ‰“ç ´è€…ï¼Œæ—§æœ‰çš„èŒƒå¼æ— æ³•æŸç¼šä½ ï¼Œä½ å°†å®šä¹‰æ–°çš„é­”æ³•çºªå…ƒã€‚" }
        };

        let currentQuestionIndex = 0;
        let userChoices = [];

        // --- æ–°å¢ï¼šéŸ³ä¹æ§åˆ¶é€»è¾‘ ---
        const bgm = document.getElementById('bgm');
        const musicIcon = document.getElementById('music-icon');
        let isMusicPlaying = false;

        function toggleBGM() {
            if (bgm.paused) {
                playMusic();
            } else {
                pauseMusic();
            }
        }

        function playMusic() {
            bgm.play().then(() => {
                isMusicPlaying = true;
                musicIcon.classList.remove('music-off');
                musicIcon.classList.add('music-playing');
            }).catch(error => {
                console.log("æ’­æ”¾å¤±è´¥ï¼Œå¯èƒ½æ˜¯äº¤äº’ç­–ç•¥é™åˆ¶:", error);
            });
        }

        function pauseMusic() {
            bgm.pause();
            isMusicPlaying = false;
            musicIcon.classList.add('music-off');
            musicIcon.classList.remove('music-playing');
        }
        // ------------------------

        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(el => el.style.display = 'none');
            const target = document.getElementById(pageId);
            target.style.display = 'flex';
            
            target.style.animation = 'none';
            target.offsetHeight; 
            target.style.animation = 'fadeIn 0.6s ease';
        }

        function startQuiz() {
            // --- ä¿®æ”¹ï¼šç‚¹å‡»å¼€å§‹æ—¶ï¼Œå¦‚æœéŸ³ä¹æ²¡æ’­æ”¾ï¼Œå°è¯•æ’­æ”¾ ---
            if (bgm.paused) {
                playMusic();
            }
            // ---------------------------------------------
            
            currentQuestionIndex = 0;
            userChoices = [];
            document.querySelectorAll('#result-page .reveal-item').forEach(item => {
                item.classList.remove('revealed');
            });
            showPage('quiz-page');
            renderQuestion();
        }

        function renderQuestion() {
            const q = questions[currentQuestionIndex];
            document.getElementById('q-count').innerText = `ç¬¬ ${currentQuestionIndex + 1} é¢˜ / å…± ${questions.length} é¢˜`;
            document.getElementById('q-text').innerText = q.question;
            
            const optionsBox = document.getElementById('options-box');
            optionsBox.innerHTML = ''; 

            q.options.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.innerText = opt.text;
                
                btn.onclick = function() {
                    this.classList.add('option-active');
                    setTimeout(() => {
                        selectOption(opt.value);
                    }, 400); 
                };
                optionsBox.appendChild(btn);
            });
        }

        function selectOption(value) {
            userChoices.push(value);

            if (currentQuestionIndex < questions.length - 1) {
                currentQuestionIndex++;
                renderQuestion(); 
                const quizPage = document.getElementById('quiz-page');
                quizPage.style.animation = 'none';
                quizPage.offsetHeight;
                quizPage.style.animation = 'fadeIn 0.6s ease';
            } else {
                revealResultWithSuspense();
            }
        }

        function revealResultWithSuspense() {
            showPage('loading-page');

            setTimeout(() => {
                const key = userChoices.slice(0, 4).join(''); 
                let resultKey = "åšå­¦"; 

                const logicMap = {
                    "AAAA": "åšå­¦", "AAAB": "åšå­¦", "AABA": "åšå­¦", "AABB": "åšå­¦",
                    "ABAA": "åšå­¦", "ABAB": "æ¢ç´¢", "ABBA": "å·§æ€", "ABBB": "å·§æ€",
                    "BAAA": "åšå­¦", "BAAB": "æ¢ç´¢", "BABA": "åšå­¦", "BABB": "å·§æ€",
                    "BBAA": "åˆ›æ–°", "BBAB": "æ¢ç´¢", "BBBA": "å·§æ€", "BBBB": "åˆ›æ–°"
                };

                if (logicMap[key]) resultKey = logicMap[key];
                const res = resultDescriptions[resultKey];

                document.getElementById('result-title').innerText = res.title;
                document.getElementById('result-desc').innerText = res.desc;
                
                showPage('result-page');

                const revealItems = document.querySelectorAll('#result-page .reveal-item');
                revealItems.forEach((item, index) => {
                    setTimeout(() => {
                        item.classList.add('revealed');
                    }, 100 * index); 
                });

            }, 2500); 
        }
    </script>
</body>
</html>
